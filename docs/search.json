[{"path":"index.html","id":"about","chapter":"1 About","heading":"1 About","text":"book sets analysis medaka approach/avoidance behaviour using 5 established inbred strains.","code":""},{"path":"hmm-parameter-optimisation.html","id":"hmm-parameter-optimisation","chapter":"2 HMM parameter optimisation","heading":"2 HMM parameter optimisation","text":"Using adapted code rule compare_params https://github.com/brettellebi/pilot_paper/blob/master/workflow/rules/05_param_optim.smkPipeline script: https://github.com/brettellebi/pilot_paper/blob/master/workflow/scripts/compare_params.R","code":"\nlibrary(tidyverse)\nlibrary(plotly)"},{"path":"hmm-parameter-optimisation.html","id":"read-in-files","chapter":"2 HMM parameter optimisation","heading":"2.1 Read in files","text":"","code":"\nCONC = list.files(\"/hps/nobackup/birney/users/ian/pilot/hmm_concordance_recode/\",full.names = T, recursive = T)\nKW = \"/hps/nobackup/birney/users/ian/pilot/kruskal_wallis/out.rds\""},{"path":"hmm-parameter-optimisation.html","id":"process","chapter":"2 HMM parameter optimisation","heading":"2.2 Process","text":"","code":"\nkw = readRDS(KW) %>% \n  dplyr::mutate(INTERVAL = as.numeric(INTERVAL)) %>% \n  dplyr::mutate(N_STATES = as.numeric(N_STATES))\n\nconc = purrr::map_dfr(CONC, readRDS) %>% \n  dplyr::group_by(INTERVAL, N_STATES) %>% \n  # get mean across groups A and B\n  dplyr::summarise(MEAN_CONC = mean(CONCORDANCE))\n#> `summarise()` has grouped output by 'INTERVAL'. You can\n#> override using the `.groups` argument.\n\ndf = dplyr::left_join(kw, conc, by = c(\"INTERVAL\", \"N_STATES\"))"},{"path":"hmm-parameter-optimisation.html","id":"plot","chapter":"2 HMM parameter optimisation","heading":"2.3 Plot","text":"","code":"\npal = colorspace::sequential_hcl(length(unique(df$N_STATES)), palette = \"ag_Sunset\")\n\nout_plot = df %>% \n  dplyr::mutate(N_STATES = factor(N_STATES, levels = sort(unique(N_STATES)))) %>% \n  dplyr::mutate(INTERVAL = factor(INTERVAL, levels = sort(unique(INTERVAL)))) %>% \n  ggplot(aes(MEAN_CONC, SUM_KW_STAT)) +\n    geom_point(aes(size = INTERVAL, colour = N_STATES),\n               alpha = 0.8) +\n    theme_bw() +\n    guides(size = guide_legend(title = \"Interval\\n(seconds)\"),\n           colour = guide_legend(title = \"N states\")) +\n    scale_colour_manual(values = pal) +\n    xlab(\"mean concordance between cross-validated HMM states\") +\n    ylab(\"summed Kruskal-Wallis statistic comparing frequency\\nof time spent in each HMM state across medaka lines\")\n\nplotly::ggplotly(out_plot)\n#> Warning: Using size for a discrete variable is not advised."}]
